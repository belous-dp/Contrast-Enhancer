# Contrast-Enhancer
Утилита для улучшения глобальной контрастности изображения, выполнена в качестве одной из домашних работ к Архитектуре ЭВМ 1 курса КТ ИТМО.

При обработке изображения используется многопоточность, реализованная с помощью библиотеки OpenMP. При компиляции без флага OpenMP будет работать в однопоточном режиме.
Работает на картинках в формате pgm, ppm, pnm.

Для улучшения контрастности используется растяжение гистограммы распределения цветов (подробнее в Отчёт.pdf). В отчёте также приложены графики для разных значений гиперпараметров при многопоточности и их анализ.

Отдельно про оценку времени работы программы. Есть два подхода: более правильный с точки зрения исследования и более правильный с точки зрения использования. В первом случае выводится время работы программы только на части, которая требовалась для улучшения контрастности. Во втором случае во время работы программы ещё включается время, затрачиваемое на предварительную обработку. Сейчас в коде используется первый вариант.

## Компиляция и запуск
Нужен C++17, тестировал на gcc и clang'е.
### Компиляция
#### gcc
`g++ -std=c++17 main.cpp Time.cpp Image.cpp -o ContrastEnhancer -fopenmp -O3 -DNDEBUG`
#### clang
`clang++ -std=c++17 main.cpp Time.cpp Image.cpp -o ContrastEnhancer -fopenmp=libomp -O3 -DNDEBUG`

Также приложен CMake файл, чтобы собрать проект из CLion или с помощью CMake (но я не знаю, как).
### Запуск
В качестве аргументов командной строки приложение принимает: количество потоков (0 -- количество потоков по умолчанию, то есть как решит OpenMP); путь к входному файлу; путь к выходному файлу; доля пикселей, которую нужно игнорировать (число в диапазоне [0, 0.5)).
Пример: `8 test.ppm out.ppm 0.1`
В этом случае программа запустится в 8-поточном режиме (если была скомпилирована с помощью OpenMP) и проигнорирует 10% пикселей с крайними значенияеми.

## Пример работы
Коэффициент 0.04, результат и тест конвертированы в jpg.

Исходная картинка:
![Исходная картинка](https://github.com/belous-dp/Contrast-Enhancer/blob/main/sample_test.jpg)

Результат:
![Результат работы](https://github.com/belous-dp/Contrast-Enhancer/blob/main/sample_test_out.jpg)